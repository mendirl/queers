@(title: String, key: String, parks: List[model.json.output.Place], velibs:List[model.json.output.Place])

@map {
    <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=@key&sensor=true"></script>
    <script type="text/javascript">
        // Enable the visual refresh
        google.maps.visualRefresh = true;

        var map;
        function initialize() {
            var mapOptions = {
                center: new google.maps.LatLng(48.85296820000001, 2.34990210),
                zoom: 14,
                mapTypeId: google.maps.MapTypeId.ROADMAP
            };
            map = new google.maps.Map(document.getElementById("map-canvas"), mapOptions);

            setMarkers(map)
        }

        function setMarkers(map) {
            @for(a <- parks) {
                var marker = new google.maps.Marker({
                    position: new google.maps.LatLng(@a.getLat,@a.getLng),
                    map: map,
                    title:"@a.getName : @a.getLeft / @a.getAll"
                });
            }

            @for(v <- velibs) {
                var image;
                @if(v.isValid) {
                   image = '/assets/images/marker-green.png'
                } else {
                   image = '/assets/images/marker-azure.png'
                }

                var marker = new google.maps.Marker({
                    position: new google.maps.LatLng(@v.getLat,@v.getLng),
                    map: map,
                    icon: image,
                    title:"@v.getName @v.getLeft / @v.getAll - @v.getDistance"
                });
            }
        }

        google.maps.event.addDomListener(window, 'load', initialize);
    </script>
}